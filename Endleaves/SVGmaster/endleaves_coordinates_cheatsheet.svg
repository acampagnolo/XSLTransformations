<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg
  PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
    x="0" y="0" width="297mm" height="210mm" viewBox="0 0 297 210"
    preserveAspectRatio="xMidYMid meet">
    <desc>Endleaves</desc>
    <defs>
        <marker id="arrowSymbol" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="strokeWidth"
            markerWidth="4" markerHeight="3" orient="auto">
            <path d="M 0,0 L 10,5 L 0,10 z" stroke="blue" fill="blue"/>
        </marker>
        <g id="outermostGL" fill="none" stroke="#000000" stroke-width="1">
            <desc>Outermost gathering (Left)</desc>
            <path d="M 141,1 L 11,1 A 10,10 0 0,0 11,21 L 141,21 z"/>
        </g>
        <pattern xmlns:xlink="http://www.w3.org/1999/xlink" id="gluedPattern"
            patternUnits="userSpaceOnUse" x="2" y="0" width="5" height="10" viewBox="0 0 10 10"
            xlink:type="simple" xlink:show="other" xlink:actuate="onLoad"
            preserveAspectRatio="xMidYMid meet">
            <desc>Glue pattern</desc>
            <path d="M 0,5 L 3,0 " stroke="grey" stroke-width="1"/>
        </pattern>
        <g id="pastedown" fill="none" stroke="#000000" stroke-width="1">
            <desc>pastedown</desc>
            <path d="M 1,1 L 131,1"/>
            <rect width="130" height="5" fill="url(#gluedPattern)" stroke-opacity="0.0"/>
        </g>
        <g id="flyleaf" fill="none" stroke="#000000" stroke-width="1">
            <desc>single flyleaf</desc>
            <path d="M 1,1 L 131,1"/>
        </g>
        <g id="foldedFlyleaf" fill="none" stroke="#000000" stroke-width="1">
            <desc>Folded flyleaves</desc>
            <path d="M 141,1 L 11,1 A 5,5 0 0,0 11,11 L 141,11"/>
        </g>
        <g id="thread" fill="none" stroke="#000000" stroke-width="0.5">
            <path d="M 0,0 L 20,0"/>
        </g>
    </defs>

    <!-- Call the definitions above inside the groups below by <use  xlink:href="[#+ID here]", use the X and Y attributes of the nested SVG node to move the components around -->
    <text dx="148.5" dy="10" font-family="serif" font-style="normal" font-weight="bold"
        font-size="10" text-anchor="middle">Endleaves</text>
    <svg>
        <g>
            <desc>Outermost gathering diagram</desc>
            <svg x="10" y="30">
                <use xlink:href="#outermostGL"/>
                <path d="M 141,1 L 151,1 M 141,21 L 151,21" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,11 L 146,2.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,11 L 146,19.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,11 L 11,2.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,11 L 2.5,11" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,11 L 11,19.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <circle r="1" cx="11" cy="11" fill="blue"/>
                <text dx="148" dy="11" dominant-baseline="central" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">20
                    units</text>
                <text dx="13" dy="11" dominant-baseline="central" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">r=10
                    units</text>
                <path d="M 1,11 L 1,36 M 11,21 L 11,29 M 141,21 L 141,36" stroke="blue"
                    stroke-width="0.5" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,27.5 L 12.5,27.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,27.5 L 139.5,27.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,34 L 2.5,34" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,34 L 139.5,34" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <text dx="76" dy="26" text-anchor="middle" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">130
                    units</text>
                <text dx="71" dy="32.5" text-anchor="middle" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">140
                    units</text>
            </svg>
            <svg x="9" y="29">
                <path d="M 0,2 L 4,2 M 2,0 L 2,4" stroke="blue" stroke-width="0.5"/>
            </svg>
            <text dx="4" dy="29" fill="blue" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="8">A</text>
        </g>
        <svg x="20" y="75">
            <use xlink:href="#pastedown"/>
            <circle r="1" cx="130" cy="1" fill="blue"/>
            <circle r="1" cx="1" cy="1" fill="blue"/>
        </svg>
        <text dx="10" dy="78" fill="blue" font-family="serif" font-style="normal"
            font-variant="normal" font-weight="bold" font-size="8">B1</text>
        <text dx="152" dy="78" fill="blue" font-family="serif" font-style="normal"
            font-variant="normal" font-weight="bold" font-size="8">B2</text>
        <svg x="20" y="90">
            <use xlink:href="#flyleaf"/>
            <circle r="1" cx="1" cy="1" fill="blue"/>
        </svg>
        <text dx="13" dy="93" fill="blue" font-family="serif" font-style="normal"
            font-variant="normal" font-weight="bold" font-size="8">D</text>
        <g>
            <svg x="10" y="104">
                <use xlink:href="#foldedFlyleaf"/>
                <path d="M 141,1 L 151,1 M 141,11 L 151,11" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,6 L 146,2.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,6 L 146,9.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,6 L 11,2.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,6 L 7.5,6" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 11,6 L 11,9.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <circle r="1" cx="11" cy="6" fill="blue"/>
                <text dx="148" dy="6" dominant-baseline="central" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">10
                    units</text>
                <text dx="13" dy="6" dominant-baseline="central" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">r=5
                    units</text>
                <path d="M 6,6 L 6,26 M 11,11 L 11,19 M 141,11 L 141,26" stroke="blue"
                    stroke-width="0.5" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,17.5 L 12.5,17.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,17.5 L 139.5,17.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,24 L 7.5,24" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 71,24 L 139.5,24" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <text dx="76" dy="16" text-anchor="middle" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">130
                    units</text>
                <text dx="73.5" dy="22.5" text-anchor="middle" fill="blue" font-family="courier"
                    font-style="normal" font-variant="normal" font-weight="100" font-size="3">135
                    units</text>
            </svg>
            <svg x="9" y="103">
                <path d="M 0,2 L 4,2 M 2,0 L 2,4" stroke="blue" stroke-width="0.5"/>
            </svg>
            <text dx="4" dy="103" fill="blue" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="8">E</text>
        </g>
    </svg>

    <svg x="-5" y="90">
        <desc>Left endleaves example</desc>
        <svg x="0" y="0">
            <g>
                <svg x="155" y="90">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#outermostGL"/>
                </svg>
            </g>
            <desc>Separate endleaves</desc>
            <desc>Unit N. 1</desc>
            <desc>Component N. 1</desc>
            <desc>Pastedown</desc>
            <g>
                <svg x="10" y="66">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#pastedown"/>
                </svg>
            </g>
            <desc>Type fold</desc>
            <g>
                <svg x="165" y="84">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#flyleaf"/>
                </svg>
            </g>
            <g stroke="red" stroke-width="1" fill="none">
                <desc>Parametric path describing the fold from the flyleaf to the pastedown</desc>
                <path d="M 166,85 Q 154,85 154,73 L 154,73 Q 154,67 141,67"/>
            </g>
            <path d="M 166,85 L 154,85" stroke="#FF6600" stroke-width="0.5" stroke-dasharray="0.5 1"
                stroke-linecap="round"/>
            <circle r="1" cx="154" cy="85" fill="#FF6600"/>
            <path d="M 154,85 L154,73" stroke="#FF6600" stroke-width="0.5" stroke-dasharray="0.5 1"
                stroke-linecap="round"/>
            <circle r="1" cx="154" cy="73" fill="#FF6600"/>
            <path d="M 154,73 L154,67" stroke="#FF6600" stroke-width="0.5" stroke-dasharray="0.5 1"
                stroke-linecap="round"/>
            <circle r="1" cx="154" cy="67" fill="#FF6600"/>
            <path d="M 154,67 L141,67" stroke="#FF6600" stroke-width="0.5" stroke-dasharray="0.5 1"
                stroke-linecap="round"/>
            <text dx="151.5" dy="89" fill="#FF6600" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="4">Q1</text>
            <text dx="147" dy="72.8" fill="#FF6600" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="4">Q2</text>
            <text dx="147" dy="66" fill="#FF6600" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="4">Q3</text>
            <desc>Sewn component</desc>
            <g stroke="red" stroke-width="0.5" fill="none">
                <path d="M 165,74 L 146,74"/>
            </g>
            <desc>Component N. 2</desc>
            <desc>Flyleaves</desc>
            <desc>Type fold</desc>
            <desc>Folded flyleaves</desc>
            <g>
                <svg x="155" y="68">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#foldedFlyleaf"/>
                </svg>
                <path d="M 165,79 L 142,79" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 165,85 L 142,85" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 165,91 L 142,91" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,81 L 146,80.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,81 L 146,83.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <text dx="143" dy="82" fill="blue" font-family="courier" font-style="italic"
                    font-weight="bold" font-size="3" dominant-baseline="central">&#916;</text>
                <path d="M 146,88 L 146,86.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 146,88 L 146,89.5" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <text dx="143" dy="88" fill="blue" font-family="courier" font-style="italic"
                    font-weight="bold" font-size="3" dominant-baseline="central">&#916;</text>
                <path d="M 155,73 L 155,60" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 161,73 L 161,60" stroke="blue" stroke-width="0.5"
                    stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 158,64 L 159.5,64" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <path d="M 158,64 L 156.5,64" stroke="blue" stroke-width="0.5"
                    marker-end="url(#arrowSymbol)" stroke-dasharray="0.5 1" stroke-linecap="round"/>
                <text dx="158" dy="63" fill="blue" font-family="courier" font-style="italic"
                    font-weight="bold" font-size="3" text-anchor="middle">&#916;</text>
            </g>
            <desc>Sewn component</desc>
            <g stroke="red" stroke-width="0.5" fill="none">
                <path d="M 165,74 L 146,74"/>
            </g>
            <circle r="1" cx="165" cy="74" fill="red"/>
            <circle r="1" cx="146" cy="74" fill="red"/>
            <text dx="167" dy="75.5" fill="red" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="5">F1</text>
            <text dx="138" dy="75.5" fill="red" font-family="serif" font-style="normal"
                font-variant="normal" font-weight="bold" font-size="5">F2</text>
        </svg>
    </svg>

    <svg x="180" y="18">
        <rect x="1" y="1" width="110" height="122" stroke="grey" stroke-width="0.5" fill="none"/>
        <text x="5" y="-4" fill="blue" font-family="serif" font-style="normal" font-variant="normal"
            font-weight="bold" font-size="4">
            <tspan x="5" dy="10" fill="#FF0099">nC<tspan x="18">=</tspan><tspan x="24"
                font-style="italic">Variable <tspan font-style="normal">'$countComponents'</tspan> in XSLT</tspan></tspan>
            <tspan x="5" dy="5" fill="#FF0099">cC<tspan x="18">=</tspan><tspan x="24"
                font-style="italic">Variable <tspan font-style="normal">'$currentComponent'</tspan> in XSLT</tspan></tspan>
            <tspan x="5" dy="7" fill="#000000">O<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic">the
                    origin (usually x = 0 and y = 0)</tspan></tspan>
            <tspan x="5" dy="7" font-style="italic">&#916;<tspan x="18">=</tspan><tspan x="24"
                    font-style="italic">6 units</tspan></tspan>
            <tspan x="5" dy="7">A<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >O</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">+ 155</tspan><tspan x="70"
                    font-style="italic">O</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan><tspan font-style="italic">+ 90</tspan></tspan>
            <tspan x="5" dy="7">B1<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >A</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">- 145</tspan><tspan x="70"
                    font-style="italic">A</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan><tspan font-style="italic">- (&#916; * (<tspan
                        fill="#FF0099">$nC</tspan> * 2))</tspan></tspan>
            <tspan x="5" dy="10">B2<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >B1</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">+ 130</tspan><tspan x="70"
                    font-style="italic">B1</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan></tspan>
            <tspan x="5" dy="10">D<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >A</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">+ 10</tspan><tspan x="70"
                    font-style="italic">A</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan><tspan font-style="italic">- &#916;</tspan></tspan>
            <tspan x="5" dy="10">E<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >A</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan x="70" font-style="italic">A</tspan><tspan
                    baseline-shift="sub" font-style="italic" font-size="3">(y)</tspan><tspan
                    font-style="italic">- (&#916; * <tspan fill="#FF0099">$cC</tspan> ) -
                10</tspan></tspan>
            <tspan x="5" dy="10" fill="red">F1<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >A</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">+ (&#916; * 1.5)</tspan><tspan x="70"
                    font-style="italic">A</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan><tspan font-style="italic">- (&#916; * <tspan
                        fill="#FF0099">$nC</tspan> ) -5</tspan></tspan>
            <tspan x="5" dy="10" fill="red">F2<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >F1</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">- (&#916; * (<tspan fill="#FF0099"
                        >$nC</tspan> + 1))</tspan><tspan x="70" font-style="italic">F1</tspan><tspan
                    baseline-shift="sub" font-style="italic" font-size="3">(y)</tspan></tspan>
            <tspan x="5" dy="10" fill="#FF6600">Q1<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >D</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">- (&#916; * 2)</tspan><tspan x="70"
                    font-style="italic">D</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan></tspan>
            <tspan x="5" dy="10" fill="#FF6600">Q2<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >D</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">- (&#916; * 2)</tspan><tspan x="70"
                    font-style="italic">D</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan><tspan>- (&#916; * 2)</tspan></tspan>
            <tspan x="5" dy="10" fill="#FF6600">Q3<tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x,y)</tspan><tspan x="18">=</tspan><tspan x="24" font-style="italic"
                    >D</tspan><tspan baseline-shift="sub" font-style="italic" font-size="3"
                    >(x)</tspan><tspan font-style="italic">- (&#916; * 2)</tspan><tspan x="70"
                    font-style="italic">B1</tspan><tspan baseline-shift="sub" font-style="italic"
                    font-size="3">(y)</tspan></tspan>
        </text>
    </svg>


</svg>
